<?xml version="1.0" encoding="UTF-8"?>
<proxy name="SMSSenderProxy" startOnLoad="true" trace="disable"
  transports="https http" xmlns="http://ws.apache.org/ns/synapse">
  <target>
    <inSequence>
      <property expression="json-eval($.type)" name="checkvalue"
        scope="default" type="STRING"/>
      <log level="custom">
        <property expression="json-eval($.type)" name="checkvalue---------------->"/>
      </log>
      <property name="transport.jms.ContentTypeProperty" scope="axis2"
        type="STRING" value="Content-Type"/>
      <filter regex="async" source="json-eval($.type)">
        <then>
          <property name="OUT_ONLY" scope="default" type="STRING" value="true"/>
          <call>
            <endpoint>
              <address trace="disable" uri="jms:/SMSStore?transport.jms.ConnectionFactoryJNDIName=QueueConnectionFactory&amp;java.naming.factory.initial=org.apache.activemq.jndi.ActiveMQInitialContextFactory&amp;java.naming.provider.url=tcp://localhost:61616&amp;transport.jms.DestinationType=queue"/>
            </endpoint>
          </call>
          <payloadFactory media-type="json">
            <format>
               {
               
               "RequestID":"12345"
               
               }
               
               
            </format>
            <args/>
          </payloadFactory>
          <respond/>
        </then>
        <else>
          <send>
            <endpoint>
              <address trace="disable" uri="jms:/SMSStore?transport.jms.ConnectionFactoryJNDIName=QueueConnectionFactory&amp;java.naming.factory.initial=org.apache.activemq.jndi.ActiveMQInitialContextFactory&amp;java.naming.provider.url=tcp://localhost:61616&amp;transport.jms.DestinationType=queue&amp;transport.jms.ReplyDestination=SMSReceiveNotificationStore"/>
            </endpoint>
          </send>
        </else>
      </filter>
    </inSequence>
    <outSequence>
      <property action="remove" name="TRANSPORT_HEADERS" scope="axis2"/>
      <send/>
    </outSequence>
    <faultSequence/>
  </target>
</proxy>
